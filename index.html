<!DOCTYPE html>
<html>
    <head>
    <script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="global.css" />
    </head>
    <body>
        <div class="container">  
        </div>
    </body>
</html>
<script>
// global grid size variables
var w = 30;
var h = 20;
var nbCells = 5;
// on document ready
$( document ).ready(function() {
    var initCells = 0;
    initGrid();
    // functions
    $( '.square' ).click(function() {
        $(this).addClass("living");
        //let id = $(this).attr("id");
        initCells++;
        if (initCells >= nbCells) {
            launchGame();
        }
        // setCellState(countLivingNeighbors(id), id);
    });
});

function launchGame() {
    jQuery('.square').unbind('click');
    alert("game is launched");
}

// functions
function initGrid() {
    var grid = "";
    for (let j=0; j <h; j++) {
        for (let i = 0; i < w; i++) {
            grid += "<div class='square' id="+j+"_"+i+"></div>";
        }
    }
    $('.container').append(grid);
};

function findLivingCells(id) {
    var livingCells = Array.from(document.getElementsByClassName('living'));
}

function setCellState(id, counter) {
    if (counter==2 || counter==3) {
        $('#'+id).addClass("living");     
    } else {
        $('#'+id).removeClass("living");
    }
}

function countLivingNeighbors(id) {
    var neighbors = findNeighbors(id);
    var counter = 0;
    for (i = 0; i < neighbors.length; i++) {
        if(neighbors[i].classList.contains("living")) {
            counter++;
        }
    }
    return counter;
}

function findNeighbors(id) {
    var neighbors = [];
    let indexArray = id.split('_');
    // first digit is line number
    let iLine = Number(indexArray[0]);
    // second is column number  
    let iCol = Number(indexArray[1]);
    console.log(iLine, iCol);
    // on top
    if (iLine!=0){
        let iLineNeighbor = iLine -1;
        neighbors.push(document.getElementById(+iLineNeighbor+'_'+iCol));
    }
    // on top left 
    // on top right
    // on left 
    if (iCol!=0){
        let iColNeighbor = iCol -1;
        neighbors.push(document.getElementById(+iLine+'_'+iColNeighbor));
    }
    // on right
    if (iCol!=(w-1)){
        let iColNeighbor = iCol +1;
        neighbors.push(document.getElementById(+iLine+'_'+iColNeighbor));
    }
    // on bottom
    if (iLine!=(h-1)){
        let iLineNeighbor = iLine +1;
        neighbors.push(document.getElementById(+iLineNeighbor+'_'+iCol));
    }
    // on bottom left 
    // on bottom right
    return neighbors;
}

</script>

